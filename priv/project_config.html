
<html>
    <head>
        <title>Project configuration</title>
        <link rel="stylesheet" type="text/css" href="/tke/static/style.css">
<script>

function addField(name, type, options) {
    fields = document.getElementById('fields');
    n = fields.childNodes.length;
    // add field n+1
    n = n + 1;
    fieldn = document.createElement('div');
    fieldn.id = 'field' + n;

    // input boxes for this field
    i = document.createTextNode('#' + n + ' ');
    fieldn.appendChild(i);

    i = document.createElement('input');
    i.name = 'field' + n + '_name';
    i.size = 30;
    i.value = name;
    fieldn.appendChild(i);

    i = document.createElement('select');
    i.name = 'field' + n + '_type';
    i.value = type;
    i.className = "updatable";
    i.onchange = fupdateThis;
    var options = ['text', 'list', 'multilist', 'user', 'textarea'];
    for (index=0; index<options.length; index++) {
        opt = document.createElement('option');
        opt.innerHTML = options[index];
        i.appendChild(opt);
    }
    fieldn.appendChild(i);
    fields.appendChild(fieldn);

}
function fupdateThis() { fupdate(this); }
    function fupdate(item) {
        //alert(item.value);
        if (item.value == "text") show_size_input(item.parentNode);
        else if (item.value == "list") show_list_input(item.parentNode);
        else if (item.value == "multilist") show_list_input(item.parentNode);
        else if (item.value == "user") show_user_input(item.parentNode);
        else if (item.value == "textarea") show_textarea_input(item.parentNode);
    }
    function show_size_input(item) {
        x = document.getElementById(item.id + '_opt');
        if (x) item.removeChild(x);
        i = document.createElement('input')
        i.name = item.id + '_opt';
        i.id = i.name;
        i.type = 'text';
        i.size = 4;
        item.appendChild(i);

        x = document.getElementById(item.id + '_help');
        if (x) item.removeChild(x);
        t = document.createElement('span');
        t.innerHTML = "(Size of the text input)";
        t.id = item.id + '_help';
        item.appendChild(t);
    }
    function show_list_input(item) {
        x = document.getElementById(item.id + '_opt');
        if (x) item.removeChild(x);
        i = document.createElement('textarea')
        i.name = item.id + '_opt';
        i.id = i.name;
        i.className = 'tke_fieldconfig';
        i.rows = 4;
        i.cols = 20;
        item.appendChild(i);

        x = document.getElementById(item.id + '_help');
        if (x) item.removeChild(x);
        t = document.createElement('span');
        t.innerHTML = "(one value on each line)";
        t.id = item.id + '_help';
        item.appendChild(t);
    }
    function show_user_input(item) {
        x = document.getElementById(item.id + '_opt');
        if (x) item.removeChild(x);
        x = document.getElementById(item.id + '_help');
        if (x) item.removeChild(x);
        t = document.createElement('span');
        t.innerHTML = "(a list of valid users will be proposed)";
        t.id = item.id + '_help';
        item.appendChild(t);
    }
    function show_textarea_input(item) {
        x = document.getElementById(item.id + '_opt');
        if (x) item.removeChild(x);
        i = document.createElement('input')
        i.name = item.id + '_opt';
        i.id = i.name;
        i.type = 'text';
        item.appendChild(i);
        
        x = document.getElementById(item.id + '_help');
        if (x) item.removeChild(x);
        t = document.createElement('span');
        t.innerHTML = "(widht, height)";
        t.id = item.id + '_help';
        item.appendChild(t);
    }
function init() {
    addField('statusX', 'list', '');
    addField('statusY', 'list', '');
    replaceContentInContainer();
}
function replaceContentInContainer() {
    matchClass = "updatable";
    
    var elems = document.getElementsByTagName('*'), i;
    for (i in elems) {
        if((' ' + elems[i].className + ' ').indexOf(' ' + matchClass + ' ')
                > -1) {
            fupdate(elems[i]);
        }
    }
}
</script>
    </head>
    <body onload="init();">
        Create new project:<br>
        <form method="POST" action="/new">
            <input type="text" size="30" name="project_name"> <br>

            <br>
            Fields:<br>
            Reserved fields: id, ctime, mtime, author, title<br>
            <div id="fields">

                <div id="field1" class="tke_fieldconfig_block">
                #1 <input type="text" size="30" name="field1" value="status">
                <select name="type1" onchange="fupdate(this);" class="updatable">
                    <option>text</option>
                    <option selected>list</option>
                    <option>multilist</option>
                    <option>user</option>
                    <option>textarea</option>
                </select>
                </div>
                <div id="field2" class="tke_fieldconfig_block">
                #2 <input type="text" size="30" name="field2" value="priority">
                <select name="type2" onchange="fupdate(this);" class="updatable">
                    <option>text</option>
                    <option selected>list</option>
                    <option>multilist</option>
                    <option>user</option>
                    <option>textarea</option>
                </select>
                </div>
                <div id="field3" class="tke_fieldconfig_block">

                #3 <input type="text" size="30" name="field3" value="owner">
                <select name="type3" onchange="fupdate(this);" class="updatable">
                    <option>text</option>
                    <option>list</option>
                    <option>multilist</option>
                    <option selected>user</option>
                    <option>textarea</option>
                </select>
                <span name="options"></span>

                </div>
            </div>
            <input type="submit" value="Create">
        </form>
    </body>
</html>
